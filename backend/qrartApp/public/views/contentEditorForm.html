<style>
	[ng-cloak] { display: none !important; }
	.variant-content { max-height: 1000px; overflow: hidden; transition: max-height 0.5s ease-in-out; }
	.variant-content.minimized { max-height: 0; }
	.editor-content { max-height: 1000px; overflow: hidden; transition: max-height 0.5s ease-in-out; }
	.editor-content.minimized { max-height: 0; }
</style>
<div class="container mx-auto max-w-4xl p-6">
	<form ng-submit="vm.submitForm()" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
		<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
			<div>
				<label for="callerName" class="block mb-2 text-sm font-medium text-gray-900">Nome Chiamante</label>
				<input type="text" id="callerName" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" ng-model="vm.formData.callerName" required>
			</div>
			<div>
				<label for="callerTitle" class="block mb-2 text-sm font-medium text-gray-900">Sottotitolo Chiamante</label>
				<input type="text" id="callerTitle" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" ng-model="vm.formData.callerTitle" required>
			</div>
			<div>
				<label for="contentName" class="block mb-2 text-sm font-medium text-gray-900">Nome Contenuto</label>
				<input type="text" id="contentName" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" ng-model="vm.formData.contentName" required>
			</div>
			<div>
				<label for="contentType" class="block mb-2 text-sm font-medium text-gray-900">Tipo di Contenuto</label>
				<select id="contentType" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" ng-model="vm.formData.contentType" required>
					<option value="">Seleziona tipo di contenuto</option>
					<option value="audio">Audio</option>
					<option value="video">Video</option>
					<option value="audio_call">Chiamata Audio</option>
					<option value="video_call">Chiamata Video</option>
				</select>
			</div>
		</div>
		
		<div ng-if="vm.formData.contentType === 'audio_call' || vm.formData.contentType === 'video_call'" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
			<div>
				<label for="callerBackground" class="block mb-2 text-sm font-medium text-gray-900">Sfondo Chiamante</label>
				<input type="file" id="callerBackground" class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none" accept="image/*">
			</div>
			<div>
				<label for="callerAvatar" class="block mb-2 text-sm font-medium text-gray-900">Avatar Chiamante</label>
				<input type="file" id="callerAvatar" class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none" accept="image/*">
			</div>
		</div>
		
		<div class="mb-6">
			<h2 class="text-lg font-semibold mb-2">Varianti Linguistiche</h2>
			<button type="button" ng-click="vm.addLanguageVariant()" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center">
				Aggiungi Variante Linguistica
			</button>
		</div>
		
		<div ng-repeat="variant in vm.formData.languageVariants" class="mb-6 p-4 border border-gray-200 rounded-lg">
			<div class="flex justify-between items-center mb-4">
				<h3 class="text-md font-semibold"> <span ng-if="!variant.language">Linguaggio {{$index + 1}}</span>  <span ng-if="variant.language">{{vm.getLanguageName(variant.language) || ''}}</span> <span ng-if="variant.textOnly">Solo testo</span>	</h3>
				<button type="button" ng-click="vm.toggleVariant($index)" class="text-gray-500 hover:text-gray-700 focus:outline-none">
					<svg class="w-6 h-6 transition-transform duration-200" ng-class="{'rotate-180': !variant.minimized}" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
					</svg>
				</button>
			</div>
			<div class="variant-content" ng-class="{'minimized': variant.minimized}">
				<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
					<div>
						<label for="language-{{$index}}" class="block mb-2 text-sm font-medium text-gray-900">Lingua</label>
						<select id="language-{{$index}}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" ng-model="variant.language" required>
							<option value="">Seleziona lingua</option>
							<option value="it">Italiano</option>
							<option value="en">Inglese</option>
							<option value="sv">Svedese</option>
							<option value="de">Tedesco</option>
						</select>
					</div>
					<div>
						<label for="textOnly-{{$index}}" class="block mb-2 text-sm font-medium text-gray-900">Solo Testo (per non udenti)</label>
						<input type="checkbox" id="textOnly-{{$index}}" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500" ng-model="variant.textOnly">
					</div>
				</div>
				
				<div class="mb-4" ng-if="variant.textOnly">
					<div class="flex justify-between items-center mb-2">
						<label for="description-{{$index}}" class="block text-sm font-medium text-gray-900">Descrizione (trascrizione dell'audio)</label>
						<button type="button" ng-click="vm.toggleEditor($index)" class="text-gray-500 hover:text-gray-700 focus:outline-none">
							<svg class="w-6 h-6 transition-transform duration-200" ng-class="{'rotate-180': !variant.editorMinimized}" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
							</svg>
						</button>
					</div>
					<div class="editor-content" ng-class="{'minimized': variant.editorMinimized}">
						<wysiwyg-editor content="variant.description" editor-id="description-{{$index}}" editor-options="vm.editorOptions" ></wysiwyg-editor>
					</div>
				</div>
				
				<div ng-if="(vm.formData.contentType === 'audio' || vm.formData.contentType === 'audio_call') && !variant.textOnly" class="mb-4">
					<label for="audioFile-{{$index}}" class="block mb-2 text-sm font-medium text-gray-900">File Audio</label>
					<input type="file" id="audioFile-{{$index}}" class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none" accept="audio/*">
				</div>
				
				<div ng-if="vm.formData.contentType === 'video' || vm.formData.contentType === 'video_call'" class="mb-4">
					<label for="videoFile-{{$index}}" class="block mb-2 text-sm font-medium text-gray-900">File Video</label>
					<input type="file" id="videoFile-{{$index}}" class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none" accept="video/*">
				</div>
				
				<button type="button" ng-click="vm.removeLanguageVariant($index)" class="mt-4 text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center">
					Rimuovi Variante Linguistica
				</button>
			</div>
		</div>
		
		<div class="flex items-center justify-end">
			<button type="submit" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center">Invia</button>
		</div>
	</form>
</div>